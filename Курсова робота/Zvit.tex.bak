\documentclass[a4paper, 12pt,oneside]{article}
\usepackage[english,russian,,ukrainian]{babel}
\usepackage[cp1251]{inputenc}
\usepackage[pdftex]{graphics}
\usepackage{graphicx}
\usepackage{amsmath,amssymb}
\usepackage{array}
\usepackage{misccorr} % в заголовках появляется точка, но при ссылке на них ее нет
\usepackage{indentfirst} % после заголовков ставится абзацный отступ

\oddsidemargin 2,54mm
\evensidemargin 2,54mm
\topmargin -1cm
\textwidth 16cm
\textheight 24cm
\headsep 0.5cm
\parindent 12mm
\sloppy


\makeatletter
\def\@seccntformat#1{
  \expandafter\ifx\csname c@#1\endcsname\c@section\else
  \csname the#1\endcsname\quad
  \fi}
\makeatother

\begin{document}
\thispagestyle{empty}
%%%%%%%%титульна сторінка
\titlepage
\begin{center}
\Large  {Львівський національний університет \\ імені Івана Франка }\\
  \normalsize{Кафедра обчислювальної математики}\\
\end{center}
\vspace*{3cm}
\begin{center}
\Large{\textbf{Курсова робота}}\\
\normalsize{на тему:}\\
\Large{\textbf{Методи обчислення композиції точок еліптичної кривої без використання інверсії}}
\end{center}
\normalsize
\vspace*{4cm}\hspace*{8cm}Студента 4-го курсу групи ПМп-41 \\
\hspace*{8cm}спеціальності.\\
\hspace*{8cm}6.040301 "Прикладна математика"\\
\hspace*{8cm}Тернового В.М.\\
\\
\hspace*{8cm}Керівник:\\
\hspace*{8cm}доц. Остудін Б.А.\\
\hspace*{8cm}\small{Національна шкала} $\underline{ \quad \quad \quad \quad \quad}$\\
\hspace*{8cm}\small{Кількість балів:} $\underline{ \quad \quad\quad}$ \small{Оцінка ECTS} $\underline{ \quad \quad \quad}$\\
\hspace*{4.4cm}\normalsize{Члени комісії}\hspace*{1cm}$\underline{ \quad \quad \quad \quad \quad}$\hspace*{0.5cm}$\underline{ \quad \quad \quad \quad \quad\quad \quad\quad \quad}$\\
\hspace*{8cm}$\underline{ \quad \quad \quad \quad \quad}$\hspace*{0.5cm}$\underline{ \quad \quad \quad \quad \quad\quad \quad\quad \quad}$\\
\hspace*{8cm}$\underline{ \quad \quad \quad \quad \quad}$\hspace*{0.5cm}$\underline{ \quad \quad \quad \quad \quad\quad \quad\quad \quad}$\\
\vspace*{4cm}\\
\centerline{Львів 2016}

\newpage
\begin{center}
\tableofcontents
\end{center}


\newpage
\section {Вступ}
Сьогодні багато конфіденційної інформації передається між комп’ютерами відкритими мережами, що потребує її захисту та автентифікації. В останній чверті минулого століття з’явилась і зараз інтенсивно розвивається криптографія з відкритими ключами на еліптичних кривих, яка дозволяє розв’язувати різноманітні задачі захисту інформації в комп’ютерних мережах.

Особливе зацікавлення в еліптичній криптографії зумовлено високою швидкодією і порівняно невеликою довжиною ключа. Наприклад, побудовані на принципах еліптичної криптографії системи з довжиною ключа 160 - 210 біт забезпечують таку саму криптостійкість, як традиційні системи при довжині ключа 1024 - 2048 біт.

В роботі розглянуто еліптичні криві та їх використання в сучасній криптографії, принципи побудови криптографічних систем на еліптичних кривих і їх застосування для систем електронного цифрового підпису.

\newpage
\section{Математичні основи}

\subsection{Еліптичні криві}
Кубічна крива на площині (x, y) (над полем дійсних чисел) називається кривою в формі Веєрштрасса, якщо вона описується рівнянням:
\begin{equation}
\label{eq:1.1}
    y^2 = x^3 + ax + b.
\end{equation}

Ця форма представлення кривої вважається канонічною. Для прикладу на рис. 1.1 наведені кубічні криві
\begin{equation*}
    y^2 = x^3 - x \quad \text{та} \quad y^2 = x^3 - x + 1.
\end{equation*}
\begin{center}
  \includegraphics [scale=1]{3.png}\\
  Рис. 1.1. Еліптичні криві.
\end{center}

Кубічні криві, які не мають особливих точок називають еліптичними кривими.
Особливими точками називають точки, в яких функція невизначена або має нерегулярну поведінку. Наприклад, точки повернення або самоперетину кубічних кривих (рис.1.2).
\begin{center}
  \includegraphics [scale=1]{1.png}\\
  Рис. 1.2. Криві з особливими точками.
\end{center}
Для того, щоб криві в формі Веєрштрасcа не мали особливих точок, дискримінант рівняння \eqref{eq:1.1}
\begin{equation}
\label{eq:1.2}
    \Delta = 4a^3 + 27b^2
\end{equation}
не має дорівнювати $0$. Еліптична крива має дві частини, якщо $\Delta < 0$ і одну частину, якщо $\Delta > 0$. Наприклад, перша крива на рис.1 має $\Delta=-4$, а друга $\Delta = 23$. Ще одною характеристикою еліптичної кривої є $j$-інваріант $j=\frac{1728(4a^3)}{\Delta}$. Криві з нульовим j-інваріантом називаються суперсингулярними, а з ненульовим - несуперсингулярними.

\subsubsection{Порядок еліптичної кривої і точок еліптичної кривої}
Порядком еліптичної кривої $N_E$ над кінцевим полем $F_q$ називається загальна кількість точок еліптичної кривої $(x, y) \in F_q$. Порядком точки $P$ еліптичної кривої називається мінімальне число $m \ge 1$ таке, що $mP = O$. Якщо такого числа не існує, то точка має нескінченний порядок. Порядок точки завжди ділить порядок еліптичної кривої. Точка з визначеним порядком називається точкою кручення (або точкою кінцевого порядку). З цього випливає, що точка $O$ є точкою невизначеного порядку.


\subsection{Скінченні поля (Галуа)}

\subsubsection{Існування скінченного поля $F(p)$}

Для будь-якого простого $p$ існує скінченне поле, що складається точно з $p$ елементів. Це поле унікально визначається з точністю до ізоморфізму і називається скінченним простим полем $F(p)$.

Елементи скінченного простого поля $F(p)$ можуть бути ідентифіковані за допомогою безлічі $[0, p-1]$ усіх позитивних цілих чисел, тобто менших за $p$. Для $F(p)$ визначено дві операції "--- складання і множення, що мають такі властивості:
\begin{enumerate}
    \item $F(p)$ "--- абелева група відносно операції складання "<+">.
    \\Для $a, b \in F(p)$ сума $a + b$ задається як $a + b := r$, де $r \in F(p)$ "--- залишок від ділення суми цілих $a + b$ на $p$;
    \item $F(p)\setminus \{0\}$ позначається як $F(p)^*$ "--- абелева група відносно операції множення "<$\times$">.
\end{enumerate}


Для $a, b \in F(p)$ результат множення $a \times b$ отримується як $a \times b := r$, де $r \in F(p)$ є залишком від ділення цілого $a \times b$ на $p$. Операція множення "<$\times$">, як правило, упускається і використовується позначення $ab$ або $a \cdot b$.

\subsubsection{Зворотний елемент групи $F(p)^*$}

Нехай $a = \gamma^j (\mod p)$ буде елементом групи $F(p)^*$. Тоді для кожного $a \in F(p)^*$ існує $b \in F(p)^*$ такий, що $a \cdot b = b \cdot a = 1$. Елемент $b$ називається мультиплікативно зворотним до елемента $a$(інверсією), позначається як $a^{-1}$ і може бути обчислений як $a^{-1} = \gamma^{p-1-j} (\mod p)$.

\subsubsection{Ділення в полі $F(p)$}

Значення $b/a$ в полі $F(p)$ існує, якщо знаменник не нульовий. В такому разі частка $b/a = b \cdot (a^{-1})(\mod p)$.

\subsubsection{Квадрати і неквадрати в полі $F(p)$}

Припустимо, що $p > 2$. Елемент $a \in F(p)^*$ називається квадратом у полі $F(p)^*$, якщо існує елемент $b \in F(p)^*$ такий, що $a = b^2 (\mod p)$. Факт існування квадратного кореня визначається за умови, що $a$ є квадратом у полі $F(p)^*$, якщо $a^{(p-1)/2} = 1$.

\subsubsection{Пошук квадратного кореня в полі $F(p)$}

Для знаходження квадратних коренів у полі $F(p)$ існують різні методи. Їх застосування дозволяє для кожного $a \in F(p)^*$ знайти $b \in F(p)^*$ таке, що \\$a = b^2 (\mod p)$, де $a$ є квадратом числа $b \in F(p)^*$.

\newpage
\section{Груповий закон для еліптичних кривих E(F(p))}

\subsection{Огляд систем координат}
Зазвичай еліптична крива визначається в афінних координатах. Тому базова точка або відкритий ключ користувача задається в афінних координатах. Головним недоліком афінних координат є складність операції ділення в полі $F(Q)$ при виконанні як складання, так і подвоєння. Зменшення складності в цілому при складанні та подвоєнні точок може досягатись засобом уникнення операції ділення, причому якомога більше. Це досягається використанням при множенні(складанні та подвоєнні точок) інших координат, таких як проективні координати, координати Якобі та модифіковані координати Якобі тощо, які є трьохмірними. Причому має забезпечуватись вимога, щоб усі системи координат, що використовуються, були сумісними.

\subsection{Груповий закон в афінних координатах}

Нехай $F(q)$ є скінченним полем Галуа з $p > 3$. Нехай $E$ є еліптичною кривою над $F(Q)$, що задається "<коротким рівнянням Веєрштрасса">
\begin{equation}
\label{eq:1.4}
    Y^2 = X^3 + aX + b, \quad a, b \in F(q),
\end{equation}
а також $4a^3 + 27b^2 \ne 0_F$ у полі $F(q)$. Тоді в афінних координатах груповий закон складання і подвоєння на еліптичній кривій \eqref{eq:1.4} задається таким чином:
\begin{enumerate}
    \item точка на нескінченності $O_E$ є одиничним елементом до операції додавання $"<+">$;
    \item усі точки $R = (x, y)$ є такими, що $R \ne O_E$;
    \item якщо $R_1 = (x_1, y_1)$ і $R_2 = (x_2, y_2)$ є дві різні точки на $E$ "--- такі, що $R_1 \ne \pm R_2$ і $R_1, R_2 \ne O_E$, то сумою точок $R_1$ та $R_2$ є точка $R_3 = (x_3, y_3)$, координати якої визначаються як:
        \begin{equation}
        \begin{split}
        \label{eq:1.5}
            x_3 & = r^2 - x_1 - x_2;\\
            y_3 & = r(x_1 - x_3) - y_1,\\
            r & = (y_2 - y_1)/(x_2 - x_1);
        \end{split}
        \end{equation}
        якщо $R = (x, y)$ є точка на $E$ "--- така, що $R \ne O_E$ і $Y \ne O_F$, то її подвоєнням є точка $2R = (x_3, y_3)$, координати якої визначаються як:
        \begin{equation}
            \begin{split}
                x_3 & = r^2 - 2x;\\
                y_3 & = r(x - x_3) - y,\\
                r & = (3x^2 + a)/(2y);
            \end{split}
        \end{equation}
        У разі якщо $R = (x, O_F)$, подвоєнням цієї точки є точка $2R = O_E$.
\end{enumerate}

Геометрична інтерпретація складання двох точок з координатами $(x_1, y_1)$ та $(x_2, y_2)$ на еліптичній кривій наведена на рис.2.1.
\begin{center}
  \includegraphics [scale=1]{2.png}\\
  Рис. 2.1. Додавання точок еліптичної кривої.
\end{center}
%Додати графік (с. 27).

\subsection{Груповий закон у проективних координатах}

Особливістю проективного базису є те, що при використанні проективних координат необхідно виконувати більше операцій множення, але немає операції ділення за модулем(інверсії). Після виконання скалярного множення в проективному базисі необхідно зробити зворотне перетворення на афінні координати. Але при виконанні перетворення з проективних координат на афінні, необхідне одне ділення в полі.

Проективний аналог короткого афінного рівняння Веєрштрасса \eqref{eq:1.4} визначається однорідним кубічним рівнянням:
\begin{equation}
\label{eq:1.7}
    Y^2Z = X^3 + aXZ^2 + bZ^3, \quad a, b \in F(Q).
\end{equation}

Безліч усіх трійок еквівалентна $(X, Y, Z)$ і позначається як $(X, Y, Z)/\sim$.

Еліптична крива, що задається в проективних координатах, складається з усіх точок $R = (X, Y, Z)$ рівняння \eqref{eq:1.7} так, що трійка $(X, Y, Z)$ є розв'язком рівняння.

Існує співвідношення між точками $Q$ кривої $E$, коли крива задана в афінних координатах, а точка $R$ "--- у проективних координатах. В такому разі справедливі твердження:
\begin{enumerate}
    \item Якщо $Q = (X_Q, Y_Q)$ є точка в афінних координатах, то $R = (X_Q, Y_Q, 1_F)$ є відповідною точкою в проективних координатах.
    \item Якщо $R = (X, Y, Z)$ і $Z \ne O_F$ є розв'язком \eqref{eq:1.7}, то $Q = (X/Z, Y/Z)$ є відповідною точкою в афінних координатах кривої $E$.
    \item Існує тільки один розв'язок \eqref{eq:1.7} із $Z = 0$, а саме: точка $(0_F, 1_F, 0_F)$, яка відповідає $O_E$.
\end{enumerate}
У проективних координатах груповий закон задається таким чином:
\begin{enumerate}
    \item точка $(0_F, 1_F, 0_F)$ є одиничним елементом $O_E$ відносно операції "<+">;
    \item точка $R_1 = (X, Y, Z) \ne (0_F, 1_F, 0_F)$ є точкою на $E$, що задана в проективних координатах, тоді точка $-R = (X, -Y, Z)$
    \item нехай $R_1 = (X_1, Y_1, Z_1)$ і $R_2 = (X_2, Y_2, Z_2)$ є дві відмінні точки на $E$ "--- такі, що $R_1 \ne R_2$ і $R_1, R_2 \ne (0_F, 1_F, 0_F)$, тоді сума $R_1$ та $R_2$ є $R_3 = (X_3, Y_3, Z_3)$
    Координати $X_3, Y_3$ і $Z_3$ можуть бути обчислені за допомогою таких формул:
    \begin{equation}
        \begin{split}
            X_3 & = -su,\\
            Y_3 & = t(u + s^2X_1Z_2) - s^3Y_1Z_2,\\
            Z_3 & = s^3Z_1Z_2,
        \end{split}
    \end{equation}
    де \quad $s=X_2Z_1-X_1Z_2,\; t=Y_2Z_1-Y_1Z_2,\; \text{та}\; u=s^2(X_1Z_2+X_2Z_1)-t^2Z_1Z_2;$

    \item якщо $R = (X, Y, Z) \ne (0_F, 1_F, 0_F)$ є точкою на $E$, тоді її подвоєння є \\$2R = (X_3, Y_3, Z_3)$.\\
    Координати точки $2R - (X_3, Y_3, Z_3)$ можуть бути обчислені за допомогою таких формул:
    \begin{equation}
        \begin{split}
            X_3 & = -su,\\
            Y_3 & = t(u + s^2X) - s^3Y,\\
            Z_3 & = s^3Z,
        \end{split}
    \end{equation}
    де \quad $t=3X^2+aZ^2,\; s=2YZ,\; \text{та}\; u=2s^2X-t^2Z$.
\end{enumerate}

\subsection{Груповий закон у проективних координатах Якобі}
Особливістю групового закону в проективіних координатах Якобі є те,  що скалярне множення вимагає більше множень, але не вимагає обчислення інверсій.

Аналогом рівняння Якобі в проективних координатах відносно короткого рівняння Веєрштрасса \eqref{eq:1.5} є кубічне рівняння:
\begin{equation}
\label{eq:1.10}
    (Jac)Y^2 = X^3 + aXZ^4 + bZ^6, \quad a, b \in F(Q).
\end{equation}

Безліч усіх трійок еквівалентна $(X, Y, Z)$ і позначається як $(X, Y, Z)/\sim$.

Існує відношення між точками $Q$ кривої $E$, коли крива задана в афінних координатах, а точки $R$ "--- у проективних координатах. Так, справедливими є твердження:
\begin{enumerate}
    \item Якщо $Q = (X_Q, Y_Q)$ є точкою в афінних координатах $E$, то $R = (X_Q, Y_Q, 1_F)$ є відповідною точкою в координатах Якобі.
    \item Якщо $R = (X, Y, Z)(Z \ne 0_F)$ є розв'язком \eqref{eq:1.10}, тобто в координатах Якобі, то $Q = (X/Z^2, Y/Z^3)$ є відповідною точкою в афінних координатах точки $E$.
    \item Існує тільки один розв'язок \eqref{eq:1.10} зі значенням $Z = 0_F$, а саме точка $(1_F, 1_F, 0_F)$, яка відповідає $O_E$.
\end{enumerate}

У проективних координатах Якобі груповий закон для \eqref{eq:1.10} задається таким чином:
\begin{enumerate}
    \item точка $(1_F, 1_F, 0_F)$ є одиничним елементом $0_E$ відносно "<+">;
    \item якщо $R = (X, Y, Z) \ne (1_F, 1_F, 0_F)$ є точкою на $E$, заданою в координатах Якобі, тоді точка $-R = (X, -Y, Z)$
    \item якщо $R_1 = (X_1, Y_1, Z_1)$ і $R_2 = (X_2, Y_2, Z_2)$ є дві відмінні точки на $E$, але такі, що $R_1 \ne R_2$ і $R_1, R_2 \ne (1_F, 1_F, 0_F)$, тоді сумою точок $R_1$ та $R_2$ є точка $R_3 = (X_3, Y_3, Z_3)$.

        Координати $X_3, Y_3$ і $Z_3$ можуть бути обчислені за допомогою таких формул:
    \begin{equation}
        \begin{split}
            X_3 & = -h^3-2u_1h^2+R^2,\\
            Y_3 & = -s_1h^3+R(u_1h^2-X_3),\\
            Z_3 & = Z_1Z_2h,
        \end{split}
    \end{equation}
    де \quad $u_1=X_1Z_{1}^{2},\; u_2=X_2Z_{1}^{2},\; s_1=Y_1Z_{2}^{3},\; s_2=Y_2Z_{1}^{3},\; h=u_2-u_1,\; \text{і}\; R=s_2-s_1;$
    \item якщо $R = (X, Y, Z) \ne (1_F, 1_F, 0_F)$ є точкою на $E$, тоді її подвоєння є \\$2R = (X_3, Y_3, Z_3)$.\\
    Координати $X_3, Y_3$ і $Z_3$ можуть бути обчислені за допомогою таких формул:
    \begin{equation}
        \begin{split}
            X_3 & = t,\\
            Y_3 & = -8Y^4+m(s-t),\\
            Z_3 & = 2YZ,
        \end{split}
    \end{equation}
    де \quad $s=4XY^2,\; m=3X^2+aZ^4,\; \text{і}\; t=-2s+m^2$.
\end{enumerate}

\subsection{Груповий закон у модифікованих координатах Якобі}
Згідно з тим же кубічним рівнянням \eqref{eq:1.10}, груповий закон у модифікованих координатах Якобі задається шляхом подання координат Якобі четвіркою координат $(X, Y, Z, aZ^4)$. Таке подання забезпечує найменшу складність операції подвоєння для еліптичної кривої $E(F(Q))$.

У модифікованих координатах Якобі груповий закон на еліптичній кривій задається таким чином:
\begin{enumerate}
    \item якщо $R_1 = (X_1, Y_1, Z_1, aZ^{4}_{1})$ і $R_2 = (X_2, Y_2, Z_2, aZ^{4}_{2})$ є дві відмінні точки на $E$ "--- такі, що $R_1 \ne R_2$ і $R_1, R_2 \ne (1_F, 1_F, 0_F, 0_F)$, тоді сумою є точка $R_3 = (X_3, Y_3, Z_3, aZ^{4}_{3})$.

        Координати $X_3, Y_3$ і $Z_3$ можуть бути обчислені за допомогою таких формул:
    \begin{equation}
        \begin{split}
            X_3 & = -h^3-2u_1h^2+R^2,\\
            Y_3 & = -s_1h^3+R(u_1h^2-X_3),\\
            Z_3 & = Z_1Z_2h,\\
            aZ^{4}_{3} & =, aZ^{4}_{3},
        \end{split}
    \end{equation}
    де \quad $u_1=X_1Z_{2}^{2},\; u_2=X_2Z_{1}^{2},\; s_1=Y_1Z_{2}^{3},\; s_2=Y_2Z_{1}^{3},\; h=u_2-u_1,\; \text{і}\; R=s_2-s_1;$
    \item якщо $R = (X, Y, Z, aZ^4) \ne (1_F, 1_F, 0_F, 0_F)$ є точкою на $E$, тоді її подвоєння є \\$2R = (X_3, Y_3, Z_3, aZ^{4}_{3})$.\\
    Координати $X_3, Y_3$ і $Z_3$ можуть бути обчислені за допомогою таких формул:
    \begin{equation}
        \begin{split}
            X_3 & = t,\\
            Y_3 & = m(s-t)-u,\\
            Z_3 & = 2YZ,\\
            aZ^{4}_{3} & = 2u(aZ^4),
        \end{split}
    \end{equation}
    де \quad $s=4XY^2,\; u=8Y^4,\; m=3X^2+(aZ^4),\; \text{і}\; t=-2s+m^2$.
\end{enumerate}

\subsection{Змішані координати}
Подання точок еліптичної кривої в афінних координатах, проективних координатах, координатах Якобі або модифікованих координатах Якобі має обчислювальні переваги й недоліки. Немає ніякої системи координат, яка забезпечує обидва як швидкі складання, так і швидкі подвоєння. Можливе змішування різних координат, тобто додавання двох точок, де перша задається в деякій одній системі координат, а друга "--- в деякій іншій системі координат. Ми можемо також вибрати систему координат результату. Оскільки ми маємо чотири різні види систем координат, це надає велике число можливостей. Змішані координати дають кращу комбінацію систем координат для подвоєнь або складань з мінімізацією часу для піднесення до степеня еліптичної кривої. Змішані координати діють найефективніше в алгоритмі попереднього обчислення.

\newpage
\section{Еліптична криптографія}
\subsection{Принципи еліптичної криптографії}
Криптосистеми типу RSA засновані на складності задачі обчислення дискретних логарифмів і розкладання великих чисел на прості множники. Але такі ж принципи можуть бути застосовані для будь-якої множини чисел, де є схожа на множення (піднесення до степеня) операція (наприклад, операція додавання) і свої закони. Суть еліптичної криптографії полягає в тому, що в ній  використовуються  групи точок еліптичних кривих з визначеними для них груповими операціями.
Еліптичний аналог традиційної криптографії з відкритим ключем виглядає таким чином:
\begin{itemize}
	\item Абоненти обирають і повідомляють всім форму еліптичної кривої та цілу точку $G$ на цій кривій, яка є генеруючою точкою.
	\item Абонент $A$ обирає ціле число $k$ і знаходить точку $PA= k \cdot G$ (додає точку $G$ до самої себе $k$ разів).
	\item Абонент $B$ обирає число $m$ і обчислює точку $PB=m \cdot G$. Потім вони обмінюються отриманими результатами і їх спільним секретним ключем стає точка $k \cdot m \cdot G$.
\end{itemize}
Щоб розкрити такий шифр, потрібно навчитися за відомими $k \cdot G$ і $G$ обчислювати $k<p$, що і є аналогом дискретного логарифмування для систем $RSA$. Досить легко обчислити $P$ за відомими $k$ і $G$, але важко обчислити $k$ за відомими $P$ і $G$.
\subsection{Електронний цифровий підпис на еліптичних кривих}
Алгоритм ЕЦП на еліптичних кривих ECDSA (Elliptic Curve Digest Signature Algorithm) використовується в різних стандартах, серед яких ANSI X9.62, FIPS-186-2, IEEE 1363-2000 та інші. Розглянемо систему ЕЦП згідно стандарту ANSI X9.62.
\subsubsection{Вимоги до еліптичних кривих згідно стандарту X9.62}
Для практичного застосування алгоритму ECDSA накладаються обмеження на поля, в яких визначені еліптичні криві, рівняння еліптичних кривих і на порядок генеруючих точок. Для забезпечення високого рівня захищенності криптографічних систем на еліптичних кривих необхідно, щоб порядок кривої $NE$ ділився на достатньо велике просте число $q$. Стандарт ANSI X9.62 вимагає $q > 2^{160}$.
Криптографічні еліптичні криві мають задовольняти наступним умовам:
\begin{enumerate}
	\item Криві розглядаються над простими полями $F_p$, де p є простим числом (або над полями характеристики два:  $F_2^m$).
	\item Крива $E_p(a,b)$ задається в формі Веєрштраса $y^2 = x^3 + ax + b$, де $a, b \in Fp$   і $(4a^3 + 27b^2) \ne 0 (mod p)$.
	\item На кривій має бути обрана генеруюча точка $G = (xG,yG)$ $( xG \; \text{і} \; yG \in Fp )$ простого порядку $q$, де $q > 2^{160}$ і $q > 4 \sqrt{p}$.
	\item Порядок кривої $N_E$  має ділитися на $q$. Результат ділення $N_E/q$ називається кофактором.
\end{enumerate}
\subsubsection{Вибір параметрів ЕЦП}
Алгоритм вибору параметрів ЕЦП виглядає наступним чином:
\begin{enumerate}
	\item Обрати хеш-функцію $h=H(M)$ , де $M$ "--- повідомлення.
	\item Обрати просте число $p$ (характеристика поля $F_p$).
	\item Обрати форму еліптичної кривої згідно описаних вище вимог, яка задає групу точок еліптичної кривої $E_p(a,b)$ і генеруючу точку $G = (x_G, y_G)$.
\end{enumerate}
\subsubsection{Генерація ключів ЕЦП}
Для ЕЦП необхідна пара ключів "--- відкритий і секретний. При цьому секретний ключ відомий тільки тому, хто підписує повідомлення, а відкритий "--- будь-кому, хто хоче перевірити його автентичність і цілісність. Також загальновідомими є параметри самого алгоритма ЕЦП, форма еліптичної кривої, генеруюча точка і хеш-функція $H(M)$.
Ключі для ЕЦП формуються наступним чином:
\begin{enumerate}
	\item Абонент $A$ обирає ціле число $d_A < p$. Це є секретним ключем абонента $А$ для його підписів. Потім він обчислює відкритий ключ $P_A=d_AG$, який є точкою кривої $E_q(a,b)$.
	\item Абонент $B$ аналогічним чином обирає свій секретний ключ $d_B$ та знаходить відкритий ключ для підписів $P_B$.
	\item Абоненти обмінюються відкритими ключами.
\end{enumerate}
\subsubsection{Формування цифрового підпису}
Для того, щоб підписати повідомлення $M$, абонент $A$ повинен зробити наступне:
\begin{enumerate}
	\item Обчислити значення хеш-функції повідомлення $M$: $h = H(M)$,  $h < p$;
	\item Обрати довільне ціле число $k_A$ з інтервалу $[1, p-1]$ (разовий ключ);
	\item Обчислити точку $R=k_AG = (x1, y1)$
	\item Обчислити значення $r = x_1 mod p$. При цьому перевіряється, щоб $r \ne 0$, бо в цьому випадку підпис $s$ не буде залежати від закритого ключа $k_A$. Якщо $r=0$, то пара чисел $(r,s)$ не може бути використана для цифрового підпису і вибирають інше значення $k_A$, тобто повертаються до кроку $2$.
	\item Обчислити зворотній елемент $k_A^{-1}$ в полі $F_p$
	\item Обчислити $s = k_A^{-1}(h + d_Ar) mod p$. Якщо $s = 0$, то значення $s^{-1} mod p$, необхідне для перевірки підпису, не існує. Тобто, у випадку $s = 0$ потрібно повернутися до кроку $2$.
\end{enumerate}
Цифровим підписом для повідомлення $M$ є пара цілих чисел $DS = (r,s)$.
Для цієї схеми можна визначити ключове рівняння
\begin{equation}
\label{eq:3.1}
    sk_A = (h + d_Ar) mod p,
\end{equation}
яке пов’язує параметри  $s$ і $r$ з разовим і секретним ключами $k_A$ і $d_A$. Воно використовується при формуванні і перевірці цифрового підпису.
\subsubsection{Перевірка цифрового підпису}
Абонент $В$ перевіряє цифровий підпис абонента $А$, маючи у розпорядженні: відкритий ключ $P_A$ абонента, параметри кривої, хеш-функцію $H(M)$ та підписане повідомлення $(M, r, s)$. Суть перевірки полягає в обчисленні на основі цих даних значення $r'$ і порівнянні його з отриманним $r$.
Помноживши \eqref{eq:3.1} на інверсію $s^{-1}$ другого параметру підпису і враховуючи, що  $P_A=d_AG$, для точок криптосистеми в результаті експоненціювання (скалярного множення) отримаємо рівність
\begin{equation}
\begin{split}
    k_AG & = s^{-1}hG + s^{-1}rd_AG = uG + vP_A,\\
    u & = s^{-1}h mod p,\\
    v & =  s^{-1}r mod p.
\end{split}
\end{equation}
Згідно пп.3 і 4 протоколу формування підпису ліва частина цього рівняння визначає точку $R = ( x1, y1)$ і, віповідно, параметр $r = x_1 mod p$. Права частина рівняння включає відомі отримувачу дані, які він використовує для обчислення параметру  $r'$. Таким чином, щоб перевірити підпис абонента $А(r,s)$ на повідомленні $M$, абонент $B$ повинен зробити наступне:
\begin{enumerate}
	\item Отримати цифровий підпис $(r,s)$ абонента $А$ для повідомлення $M$;
	\item Обчислити значення хеш-функції повідомлення $h = H(M)$;
	\item Обчислити зворотній елемент $s^{-1}$ в полі $F_p$;
	\item Обчислити $u = s^{-1}h mod n$, $v = s^{-1}r mod p$;
	\item Обчислити точку $R'= uG + vP_A =  ( x'_1, y'_1)$;
	\item Обчислити $r' = x'_1 mod p$;
	\item Підпис вірний, якщо $r' = r$.
\end{enumerate}

\newpage
\section{Приклади застосування}
\subsection{Визначення порядку канонічних еліптичних кривих}
Розглянемо канонічну еліптичну криву $E_p$ над простим полем Галуа.
Нехай $\chi(z)$ "--- квадратичний характер елемента $z$  поля  $F_p$, такий що
\begin{equation}
\label{eq:4.3}
\chi(z) = \begin{cases}
            1, & z=a^2 \\
            -1, & z \ne a^2, \quad a \in F_p\\
            0, & z=0.
            \end{cases}
\end{equation}
Тобто, якщо $z$ має квадратний корінь в полі $F_p$, то $\chi(z) = 1$, якщо ні, то $\chi(z) = -1$. В першому випадку кажуть, що $z$ є квадратичним залишком, у  другому – квадратичним незалишком. З урахуванням \eqref{eq:1.1} порядок кривої можливо розрахувати перебором всіх елементів поля $F_p$ як суму
\begin{equation}
\label{eq:4.4}
\begin{split}
    N_E & = 1+\sum_{x \in F_p}\chi \{(x^3+ax+b)+1\} = p+1+\sum_{x \in F_p}\chi \{(x^3+ax+b)\} = p+1-t,\\
    \text{де} \; t & = -\sum_{x \in F_p}\chi \{(x^3+ax+b)\}
\end{split}
\end{equation}
Перша одиниця в формулі \eqref{eq:4.4} враховує точку $O$, а під знаком суми кожен розв’язок $х$ рівняння \eqref{eq:1.1} дає по дві точки кривої $Е$. Винятком є точки другого порядку з координатою $y = 0$, які згідно з \eqref{eq:4.3}, \eqref{eq:4.4} враховуються по одному разу.

{\bf Приклад 1.} Розглянемо криву $y^2 = x^3 + 1$ над полем $F_5$ . Перебором значень $x$ отримаємо всі  рішення рівняння, які зведені в Таблиці 1.


Таблиця 1. Визначення координат точок кривої $y^2 = x^3 + 1$ над полем $F_5$
\begin{center}
\setlength{\extrarowheight}{2pt}
\begin{tabular}{|l|l|l|l|l|l|}
\hline
$x$ & $0$ & $1$ & $2$ & $3$ & $4$
\\ \hline
$x^2$ & $0$ & $1$ & $4$ & $4$ & $1$\\\hline
$y^2$ & $1$ & $2$ & $4$ & $3$ & $0$\\\hline
$y_1$ & $1$ & $-$ & $2$ & $-$ & $0$\\\hline
$y_2$ & $-1$ & $-$ & $-2$ & $-$ & $ $\\
\hline
\end{tabular}
\end{center}

У цій таблиці для наочності використано додатні та від’ємні значення $y$ координати. Значення $y = -1$ порівнюється з додатнім залишком  $p-1 =4$, \; a \; \\$y = -2 \equiv 3 \mod 5$. Разом з точкою $O$ порядок кривої дорівнює $6$.

\subsection{Проективна заміна координат}
На рисунку продемонстровано приклад проективної заміни координат для кривої $x^3 + y^3 = 1$.
\begin{center}
  \includegraphics [scale=0.6]{4.png}\\
  Рис. 5.1. Проективна заміна координат для кривої $x^3 + y^3 = 1$
\end{center}
а) Крива $x^3 + y^3 = 1$. б) Заміна $x = s - t, \; y = t$ \; "--- паралельна проекція площини $xy$ на площину $st$. в) Крива $s^3 - 3s^2t + 3st^2 = 1$. г) Заміна $s = 1/3u$ ,
$t = (6v+1)/6u$ \; "--- центральна проекція площини $st$ на площину $uv$. д) Крива $v^2 = u^3 - 1/108$ в формі Веєрштраса.

\subsection{Складність групової операції для канонічної кривої}
Розглянемо канонічну еліптичну криву у формі Веєрштраса над полем Fq \eqref{eq:1.1} із законом додавання точок
\begin{equation}
(x_1,y_1 )+(x_2,y_2 )= \left(\left(\frac{y_2-y_1}{x_2-x_1}\right)^2-x_1-x_2 , -y_1-\left(\frac{y_2- y_1}{x_2-x_1}\right)(x_3-x_1)\right)
\end{equation}
В проективних координатах із заміною $x = X/Z$ , $y = Y/Z$ маємо
\begin{equation}
\frac{\frac{Y_2}{Z_2}-\frac{Y_1}{Z_1} }{\frac{X_2}{Z_2}-\frac{X_1}{Z_1}} = \frac{u}{v}. \quad u=Y_2Z_1-Y_1Z_2, \; v=X_2Z_1-X_1Z_2
\end{equation}
Тоді
\begin{equation}
\frac{X_3}{Z_3} = \left(\frac{u}{v}\right)^2-\frac{X_1}{Z_1}-\frac{X_2}{Z_2} = \frac{Z_1Z_2u^2-v^2(X_1Z_2+X_2Z_1)}{Z_1Z_2v^2} = \frac{vg}{Z_3},
\end{equation}
де
\begin{equation}
    Z_3 = Z_1Z_2v^3, \; g = Z_1Z_2u^2-v^3-2v^2X_1Z_2.
\end{equation}
Далі
\begin{equation}
    \frac{Y_3}{Z_3} = -\frac{Y_1}{Z_1}+\left(\frac{u}{v}\right)\left(\frac{X_1}{Z_1}-\frac{vg}{Z_1Z_2v^3}\right) = \frac{-Y_1Z_2v^3+u(X_1Z_2v^2-g)}{Z_1Z_2v^3}
\end{equation}
В результаті, маємо
\begin{equation}
\begin{split}
    X_3 & = vg,\\
    Y_3 & = -Y_1Z_2v^3+u(X_1Z_2v^2-g),\\
    Z_3 & = Z_1Z_2v^3
\end{split}
\end{equation}
Підрахунок кількості операцій дає складність обчислення суми точок канонічної еліптичної кривої $VE = 12M + 2S$.

\section{Апробація}
\begin{center}
  \includegraphics [scale=0.6]{Example_1.png}\\
  Рис. 5.1. Приклад виконання програми.
\end{center}

\begin{center}
  \includegraphics [scale=0.6]{Example_2.png}\\
  Рис. 5.1. Приклад виконання програми.
\end{center}



\newpage
\section {Висновок}

В даній роботі було розглянуто еліптичні криві в скінченних полях $F_p$. Досліджено груповий закон в різних системах координат. Розглянуто принципи еліптичної криптографії.Особливе зацікавлення в еліптичній криптографії зумовлено високою швидкодією і порівняно невеликою довжиною ключа. Наприклад, побудовані на принципах еліптичної криптографії системи з довжиною ключа 160 - 210 біт забезпечують таку саму криптостійкість, як традиційні системи при довжині ключа 1024 - 2048 біт.

В роботі розглянуто еліптичні криві та їх використання в сучасній криптографії, принципи побудови криптографічних систем на еліптичних кривих і їх застосування для систем електронного цифрового підпису.

 Розглянуті методи забезпечать при обумовленій стійкості найвищу продуктивність обчислень групових операцій. Методи що базуються на еліптичних кривих можна рекомендувати як для майбутніх криптографічних стандартів, так і для використання в криптопротоколах вже сьогодні.
\newpage
\begin{center}
\addcontentsline{toc}{section}{Список літератури}
\end{center}
\begin{thebibliography}{99}
\bibitem{Author}\emph{Горбенко І.Д., Горбенко Ю.І.} Прикладна криптологія:Теорія.Практика.Застосування: Монографія. Вид.2-ге, перероб.ідоп. "--- Харків: Видавництво "<Форт">, 2012. "--- 880с.
\bibitem{Author}\emph{Иванов М.А.} Криптографические методы защиты информации в компьютерных системах и сетях, "--- М.:Кудиц-Образ, 2001 г. "--- 368с.
\bibitem{Author}\emph{Рябко Б.Я., Фионов А.Н.} Основы современной криптографии и стеганографии, - М.: Научный мир, 2004 г. - 173с.
\bibitem{Author}\emph{О.В.Вербіцький} Втуп до криптології, - Львів: Видавництво наукової технічної літератури, 1998. - 247 с.
\bibitem{Author}\emph{Шнайер Брюс, Фергюсон Нильс} Практическая криптография, 2-е изд. - М: ООО "И.Д.Вильямс", 2005. — 424 с.
\end{thebibliography}




\end{document}
